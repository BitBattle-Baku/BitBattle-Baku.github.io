<!DOCTYPE html>
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BitBattle | Global Arena Pro</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Poppins:wght@300;500;800&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #02050a; --panel: rgba(11, 17, 29, 0.85); --neon-blue: #00f2ff; --neon-pink: #ff00ff; --neon-green: #39ff14; }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            background: #000 url('https://r.resimlink.com/5S9vXzO.png') no-repeat center center fixed; 
            background-size: cover;
            min-height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            font-family: 'Poppins', sans-serif; 
            color: white; 
            overflow-x: hidden; 
            padding: 20px; 
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(0, 242, 255, 0.4); } 70% { box-shadow: 0 0 0 15px rgba(0, 242, 255, 0); } 100% { box-shadow: 0 0 0 0 rgba(0, 242, 255, 0); } }
        @keyframes giftBounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }

        .card { 
            background: var(--panel); 
            backdrop-filter: blur(12px);
            padding: 40px; border-radius: 30px; border: 2px solid var(--neon-blue); 
            width: 100%; max-width: 420px; text-align: center; 
            box-shadow: 0 0 40px rgba(0, 242, 255, 0.15); position: relative; z-index: 5;
            animation: fadeIn 0.5s ease-out;
        }

        .gift-btn {
            background: linear-gradient(45deg, #ff00ff, #800080);
            border: 1px solid white;
            color: white;
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 0.7rem;
            cursor: pointer;
            margin-bottom: 15px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            animation: giftBounce 2s infinite;
        }

        .side-leaderboard { 
            position: fixed; right: 20px; top: 50%; transform: translateY(-50%); 
            width: 280px; background: rgba(11, 17, 29, 0.9); 
            backdrop-filter: blur(8px); border: 2px solid var(--neon-pink); padding: 15px; border-radius: 15px; 
            max-height: 90vh; display: flex; flex-direction: column; z-index: 10; 
            box-shadow: 0 0 20px rgba(255, 0, 255, 0.2); 
        }

        .leader-list { overflow-y: auto; flex-grow: 1; max-height: 180px; margin-bottom: 10px; }
        .leader-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 0; border-bottom: 1px solid rgba(255,255,255,0.1); font-size: 0.8rem; }
        .vip-tag { color: var(--neon-green); font-weight: bold; font-size: 0.6rem; margin-left: 5px; border: 1px solid; padding: 1px 3px; border-radius: 3px; }

        .chat-container { border-top: 2px solid var(--neon-blue); padding-top: 10px; display: flex; flex-direction: column; height: 250px; }
        #chat-messages { flex-grow: 1; overflow-y: auto; font-size: 0.75rem; margin-bottom: 10px; padding-right: 5px; text-align: left; }
        .chat-msg { margin-bottom: 5px; line-height: 1.2; }
        .chat-user { font-weight: bold; color: var(--neon-blue); }
        .chat-input-area { display: flex; gap: 5px; }
        .chat-input-area input { margin-bottom: 0 !important; padding: 8px !important; font-size: 0.75rem !important; background: rgba(0,0,0,0.4) !important; border: 1px solid #333 !important; }
        .chat-send { background: var(--neon-blue); color: black; border: none; padding: 0 10px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        h1 { font-family: 'Orbitron', sans-serif; color: var(--neon-blue); margin-bottom: 25px; text-shadow: 0 0 10px var(--neon-blue); }
        .btn { width: 100%; padding: 14px; margin: 10px 0; border: none; border-radius: 10px; background: linear-gradient(45deg, var(--neon-blue), var(--neon-pink)); color: white; font-weight: 900; cursor: pointer; text-transform: uppercase; transition: 0.3s; }
        .btn:hover { transform: scale(1.02); filter: brightness(1.2); }
        .pulse-btn { animation: pulse 2s infinite; }
        .btn-wa { background: #25D366 !important; box-shadow: 0 0 15px #25D366; }
        .btn-duel { background: linear-gradient(45deg, #7b2ff7, #f107a3) !important; font-size: 0.7rem; }
        
        input { width: 100%; padding: 12px; background: rgba(21, 28, 44, 0.6); border: 1px solid var(--neon-blue); color: white; border-radius: 8px; margin-bottom: 15px; text-align: center; outline: none; }
        .hidden { display: none !important; }
        .id-display { color: var(--neon-green); font-weight: bold; font-family: monospace; border: 1px dashed var(--neon-green); padding: 5px 15px; margin: 10px 0; display: inline-block; }
        .opt-btn { width: 100%; padding: 12px; margin-bottom: 8px; background: rgba(26, 36, 58, 0.7); border: 1px solid var(--neon-blue); color: white; border-radius: 8px; cursor: pointer; transition: 0.2s; }
        .opt-btn:hover { background: rgba(0, 242, 255, 0.2); }
        .rank-tag { font-size: 0.7rem; padding: 2px 8px; border-radius: 10px; margin-left: 5px; vertical-align: middle; }
        
        .add-friend { background: var(--neon-green); color: black; border: none; border-radius: 4px; padding: 2px 6px; cursor: pointer; font-weight: bold; font-size: 0.7rem; }

        /* Yeni Dostluq Paneli Stili */
        .friends-panel {
            background: rgba(0,0,0,0.5); border-radius: 15px; padding: 10px; margin-top: 15px; text-align: left;
        }
        .friend-row {
            display: flex; justify-content: space-between; align-items: center; 
            padding: 5px; border-bottom: 1px solid #333; font-size: 0.8rem;
        }
        .status-dot { width: 8px; height: 8px; background: #555; border-radius: 50%; display: inline-block; margin-right: 5px; }
        .status-online { background: var(--neon-green); box-shadow: 0 0 5px var(--neon-green); }

        .footer-trigger { 
            position: fixed; bottom: 10px; right: 10px; 
            font-size: 0.6rem; color: var(--neon-blue); 
            cursor: pointer; opacity: 0.15; z-index: 100;
        }

        @media (max-width: 850px) {
            body { flex-direction: column; overflow-y: auto; justify-content: flex-start; padding-top: 20px; }
            .side-leaderboard { position: relative; right: auto; top: auto; transform: none; width: 100%; max-width: 420px; margin-top: 20px; order: 2; }
            .card { order: 1; }
        }
    </style>
</head>
<body>

    <div class="card" id="scr-auth">
        <h1>BIT BATTLE</h1>
        <div id="auth-reg">
            <input type="text" id="reg-name" placeholder="D√∂y√º≈ü√ß√º Adƒ±">
            <input type="password" id="reg-pass" placeholder="Yeni ≈ûifr…ô">
            <button class="btn" onclick="register()">Qeydiyyatdan Ke√ß</button>
            <p style="font-size: 0.8rem; margin-top: 10px;">Hesabƒ±n var? <a href="#" onclick="toggleAuth(true)" style="color: var(--neon-blue);">Giri≈ü</a></p>
        </div>
        <div id="auth-login" class="hidden">
            <input type="text" id="login-id" placeholder="BIT-ID (M…ôs: BIT-1234)">
            <input type="password" id="login-pass" placeholder="≈ûifr…ôniz">
            <button class="btn" onclick="login()">Daxil Ol</button>
            <p style="font-size: 0.8rem; margin-top: 10px;"><a href="#" onclick="toggleAuth(false)" style="color: var(--neon-blue);">Qeydiyyat</a></p>
        </div>
    </div>

    <div class="card hidden" id="scr-dash">
        <p style="font-size: 0.75rem;">Status: <span id="u-rank" class="rank-tag">Pilot</span></p>
        <div class="id-display" id="u-id">...</div>
        <h2 id="u-welcome" style="margin: 10px 0; font-family:'Orbitron';">Pilot</h2>

        <button id="gift-trigger" class="gift-btn" onclick="claimDailyBonus()">
            üéÅ G√úND∆èLƒ∞K BONUS
        </button>

        <div style="display: flex; justify-content: space-around; margin: 20px 0; border-top: 1px solid #222; padding-top: 15px;">
            <span>BIT: <b id="u-bits" style="color:var(--neon-blue)">0</b></span>
            <span>Limit: <b id="u-limit" style="color:var(--neon-pink)">2/2</b></span>
        </div>
        
        <div id="btn-container"></div>
        
        <button class="btn" style="background: #333; margin-top: 10px;" onclick="showFriendPanel()">DOSTLUQ V∆è DUEL ‚öîÔ∏è</button>
        
        <div id="friend-section" class="friends-panel hidden">
            <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                <input type="text" id="friend-id-input" placeholder="Dostunun ID-sini yaz" style="margin:0; font-size: 0.7rem; padding: 5px;">
                <button onclick="sendFriendRequest()" class="add-friend" style="padding: 0 10px;">∆èlav…ô Et</button>
            </div>
            <h4 style="font-size: 0.7rem; color: var(--neon-pink);">AKTƒ∞V DOSTLAR</h4>
            <div id="active-friends-list" style="max-height: 100px; overflow-y: auto;">
                <p style="font-size: 0.6rem; color: #666;">Y√ºkl…ônir...</p>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 5px; margin-top: 10px;">
                <button class="btn btn-duel" onclick="startDuel('1v1')">1 V 1 DUEL</button>
                <button class="btn btn-duel" style="background: linear-gradient(45deg, #ff9900, #ff4400) !important;" onclick="startDuel('2v2')">2 V 2 ARENA</button>
            </div>
        </div>
    </div>

    <div class="card hidden" id="scr-game">
        <div id="timer" style="font-size: 2.5rem; color: var(--neon-green); font-family: 'Orbitron';">10</div>
        <p id="q-text" style="margin: 25px 0; font-size: 1.1rem; min-height: 60px; font-weight: 500;"></p>
        <div id="q-opts"></div>
    </div>

    <div class="card hidden" id="scr-matchmaking">
        <h2 style="font-family:'Orbitron'; color: var(--neon-pink);">ARENA E≈ûL∆è≈ûM∆èSƒ∞</h2>
        <div class="pulse-btn" style="width:100px; height:100px; border-radius:50%; border:5px solid var(--neon-blue); margin: 30px auto; display: flex; align-items: center; justify-content: center;">
            <span id="match-timer">00:00</span>
        </div>
        <p id="match-status" style="font-size: 0.8rem;">Dig…ôr oyun√ßular axtarƒ±lƒ±r...</p>
        <div id="match-players" style="margin-top: 20px; text-align: left; font-size: 0.7rem;"></div>
    </div>

    <div class="card hidden" id="scr-admin">
        <h2 style="color:red; font-family:'Orbitron';">Sƒ∞STEM ADMƒ∞N</h2>
        <p id="admin-count" style="font-size: 0.8rem; color: #aaa; margin-bottom: 10px;">Y√ºkl…ônir...</p>
        <input type="password" id="admin-pass" placeholder="≈ûifr…ô">
        <button class="btn" onclick="checkAdmin()">Yoxla</button>
        <div id="admin-tools" class="hidden">
            <input type="text" id="target-id" placeholder="ƒ∞stifad…ô√ßi ID">
            <button class="btn" style="background:green" onclick="makeVIP()">VIP ET</button>
            <button onclick="show('scr-dash')" class="btn" style="background:gray">Geri</button>
        </div>
    </div>

    <div class="side-leaderboard">
        <h3 style="font-family:'Orbitron'; font-size: 0.8rem; color: var(--neon-pink); text-align: center; margin-bottom: 10px;">GLOBAL TOP 10</h3>
        <div class="leader-list" id="leader-list">...</div>
        <br>
        <div class="chat-container">
            <h4 style="font-size: 0.7rem; color: var(--neon-blue); margin-bottom: 5px;">CANLI √áAT</h4>
            <div id="chat-messages"></div>
            <div class="chat-input-area">
                <input type="text" id="chat-input" placeholder="Yaz...">
                <button class="chat-send" onclick="sendMsg()">></button>
            </div>
        </div>
        <button onclick="logout()" style="background:none; border:none; color:#ff4444; cursor:pointer; font-size:0.6rem; margin-top:10px;">√áƒ±xƒ±≈ü</button>
    </div>

    <div class="footer-trigger" onclick="adminClick()">ismayilovismayil</div>

    <script>
        const sfx = {
            correct: new Audio('https://s3.amazonaws.com/freecodecamp/drums/Heater-1.mp3'),
            wrong: new Audio('https://s3.amazonaws.com/freecodecamp/drums/Dsc_Oh.mp3')
        };

        function unlockAudio() {
            sfx.correct.play().then(() => { sfx.correct.pause(); sfx.correct.currentTime = 0; });
            sfx.wrong.play().then(() => { sfx.wrong.pause(); sfx.wrong.currentTime = 0; });
            document.removeEventListener('click', unlockAudio);
        }
        document.addEventListener('click', unlockAudio);

        const firebaseConfig = {
            apiKey: "AIzaSyBDez5-5JBRKWruTeRQ5GmMCX9we0iP00",
            authDomain: "bitbattle-64c13.firebaseapp.com",
            databaseURL: "https://bitbattle-64c13-default-rtdb.firebaseio.com",
            projectId: "bitbattle-64c13",
            storageBucket: "bitbattle-64c13.firebasestorage.app",
            messagingSenderId: "735228613710",
            appId: "1:735228613710:web:14a6cee6f896ceffc11f1f",
            measurementId: "G-S7LPFQ9JCW"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        const questions = [
            { q: "Hansƒ± t…ôr…ôzi il…ô √ß…ôki √ß…ôkm…ôk olmaz?", o: ["M…ôtb…ôx", "B√ºrcl…ôr", "Elektron", "Mexaniki"], c: 1 },
            { q: "M…ôn danƒ±≈ümƒ±ram, amma h…ôr ≈üey…ô cavab verir…ôm. N…ôy…ôm?", o: ["G√ºzg√º", "Kitab", "∆èks-s…ôda", "K√ºl…ôk"], c: 2 },
            { q: "Bir ail…ôd…ô 7 bacƒ± var, h…ôr birinin bir qarda≈üƒ± var. C…ômi ne√ß…ô u≈üaq var?", o: ["7", "8", "14", "15"], c: 1 },
            { q: "N…ô q…ôd…ôr √ßox g√∂t√ºrs…ôn, o q…ôd…ôr b√∂y√ºy…ôr?", o: ["Borc", "√áala", "Bilik", "Y√ºk"], c: 1 },
            { q: "Hansƒ± ayda 28 g√ºn var?", o: ["Fevral", "Yanvar", "B√ºt√ºn aylar", "He√ß biri"], c: 2 },
            { q: "Atanƒ±n 35, oƒülunun 7 ya≈üƒ± var. Ne√ß…ô ild…ôn sonra ata oƒülundan 3 d…ôf…ô b√∂y√ºk olar?", o: ["5", "7", "8", "10"], c: 1 },
            { q: "1-d…ôn 100-…ô q…ôd…ôr ne√ß…ô d…ôn…ô 9 r…ôq…ômi var?", o: ["10", "11", "19", "20"], c: 3 },
            { q: "Hansƒ± s√∂z dig…ôrl…ôrind…ôn f…ôrqlidir?", o: ["Alma", "Armud", "K√∂k", "Gilas"], c: 2 },
            { q: "Kitab - M√º…ôllif, Film - ?", o: ["Aktyor", "Rejissor", "Ssenari", "Kamera"], c: 1 },
            { q: "Onu yem…ôk olar, amma √∂z√º yey…ô bilm…ôz. N…ôdir?", o: ["Bo≈üqab", "√á√∂r…ôk", "Su", "Qa≈üƒ±q"], c: 0 },
            { q: "Gec…ô-g√ºnd√ºz h…ôr…ôk…ôt edir, amma yerind…ôn t…ôrp…ônmir?", o: ["Saat", "√áay", "K√ºl…ôk", "Yol"], c: 0 },
            { q: "Ayaƒüƒ± yoxdur qa√ßƒ±r, qanadƒ± yoxdur u√ßur, dili yoxdur aƒülayƒ±r?", o: ["K√ºl…ôk", "Bulud", "Duman", "Yaƒüƒ±≈ü"], c: 1 },
            { q: "N…ôdir ki, ba≈üƒ± var, beyni yoxdur?", o: ["Mismar", "Sancaq", "Soƒüan", "K…ôl…ôm"], c: 2 },
            { q: "Hansƒ± suala 'h…ô' cavabƒ± verm…ôk m√ºmk√ºn deyil?", o: ["Acƒ±rsan?", "Yatƒ±rsan?", "Yorulubsan?", "G√∂r√ºrs…ôn?"], c: 1 },
            { q: "S…ôh…ôr-s…ôh…ôr n…ôyi yem…ôk olmaz?", o: ["Naharƒ±", "Yem…ôyi", "√áayƒ±", "Yuxunu"], c: 0 },
            { q: "Aƒüzƒ± var, dili yoxdur, canƒ± yoxdur, n…ôf…ôsi var?", o: ["T√ºf…ông", "Fleyta", "K√ºl…ôk", "Balon"], c: 0 },
            { q: "Onu hamƒ± g√∂r√ºr, amma Tanrƒ± he√ß vaxt g√∂rm√ºr?", o: ["ƒ∞nsan", "Peyƒü…ômpl…ôr", "B…ôrab…ôrini", "G…ôl…ôc…ôyi"], c: 2 },
            { q: "Bir adam yaƒüƒ±≈üƒ±n altƒ±nda qalƒ±r, amma sa√ßlarƒ± islanmƒ±r. Niy…ô?", o: ["√á…ôtiri var", "Papaƒüƒ± var", "Ke√ß…ôldir", "Qa√ßƒ±r"], c: 2 },
            { q: "Hansƒ± qabdan yem…ôk yem…ôk olmaz?", o: ["Bo≈ü qabdan", "Sƒ±nƒ±q qabdan", "Dolu qabdan", "√áirkli qabdan"], c: 0 },
            { q: "Onu hamƒ± saxlayƒ±r, amma he√ß kim g√∂rm√ºr?", o: ["S√∂z√º", "N…ôf…ôsi", "Sirri", "Canƒ±"], c: 1 },
            { q: "2, 6, 12, 20, ? Ardƒ±cƒ±llƒ±ƒüƒ± tamamlayƒ±n.", o: ["24", "26", "30", "32"], c: 2 },
            { q: "√ú√ß ardƒ±cƒ±l …ôd…ôdin c…ômi 33-d√ºr. ∆èn b√∂y√ºy√º ne√ß…ôdir?", o: ["10", "11", "12", "13"], c: 2 },
            { q: "∆èqr…ôbl…ôr saat 03:15-d…ô ne√ß…ô d…ôr…ôc…ôlik bucaq …ôm…ôl…ô g…ôtirir?", o: ["0", "7.5", "15", "90"], c: 1 },
            { q: "6 n…ôf…ôr bir-biri il…ô …ôl sƒ±xƒ±≈üƒ±rsa, c…ômi ne√ß…ô …ôl sƒ±xma olar?", o: ["12", "15", "18", "21"], c: 1 },
            { q: "H…ôr 5 d…ôqiq…ôd…ô bir ikiy…ô b√∂l√ºn…ôn bakteriya, 1 saatda ne√ß…ô d…ôf…ô b√∂l√ºn…ôr?", o: ["6", "10", "12", "60"], c: 2 },
            { q: "D√ºnyanƒ±n …ôn h√ºnd√ºr zirv…ôsi hansƒ±dƒ±r?", o: ["Everest", "Elbrus", "Qazbek", "≈ûahdaƒü"], c: 0 },
            { q: "Hansƒ± okeanƒ±n sah…ôsi …ôn b√∂y√ºkd√ºr?", o: ["Atlantik", "Hind", "Sakit", "≈ûimal Buzlu"], c: 2 },
            { q: "Az…ôrbaycanƒ±n …ôn uzun √ßayƒ± hansƒ±dƒ±r?", o: ["Araz", "K√ºr", "Samur", "T…ôrt…ôr"], c: 1 },
            { q: "Hansƒ± √∂lk…ô 'G√ºndoƒüan √∂lk…ô' adlanƒ±r?", o: ["√áin", "Koreya", "Yaponiya", "Vyetnam"], c: 2 },
            { q: "G√ºn…ô≈ü sistemind…ô …ôn b√∂y√ºk planet hansƒ±dƒ±r?", o: ["Mars", "Saturn", "Yupiter", "Neptun"], c: 2 },
            { q: "Y√ºz il ya≈üayan aƒüacƒ±n yarpaqlarƒ± n…ô r…ông olur?", o: ["Ya≈üƒ±l", "Q…ôhv…ôyi", "Sarƒ±", "Quru"], c: 0 },
            { q: "Yalnƒ±z t…ôk r…ôq…ôml…ôrd…ôn ibar…ôt …ôn b√∂y√ºk iki r…ôq…ômli …ôd…ôd?", o: ["91", "97", "99", "89"], c: 2 },
            { q: "Sƒ±fƒ±rdan f…ôrqli …ôd…ôdi √∂z√ºn…ô b√∂ld√ºkd…ô n…ô alƒ±nƒ±r?", o: ["0", "1", "√ñz√º", "Sonsuz"], c: 1 },
            { q: "Ardƒ±cƒ±llƒ±ƒüƒ± tamamla: 1, 8, 27, 64, ?", o: ["100", "121", "125", "150"], c: 2 },
            { q: "∆èlifbamƒ±zda ne√ß…ô sait var?", o: ["7", "8", "9", "10"], c: 2 },
            { q: "H…ôm meyv…ôdir, h…ôm d…ô r…ông?", o: ["Nar", "Limon", "Portaƒüal", "Banan"], c: 2 },
            { q: "Su ne√ß…ô d…ôr…ôc…ôd…ô donur?", o: ["-1", "0", "1", "4"], c: 1 },
            { q: "Hansƒ± metal otaq temperaturunda maye halƒ±ndadƒ±r?", o: ["Qurƒüu≈üun", "Civ…ô", "Qalay", "Mis"], c: 1 },
            { q: "Bir kilo pambƒ±q aƒüƒ±rdƒ±r, yoxsa bir kilo d…ômir?", o: ["Pambƒ±q", "D…ômir", "B…ôrab…ôrdir", "H…ôcm…ô baƒülƒ±dƒ±r"], c: 2 },
            { q: "≈ûahmat taxtasƒ±nda ne√ß…ô xana var?", o: ["32", "60", "64", "100"], c: 2 },
            { q: "Bir aƒüacƒ±n 10 budaƒüƒ± var, h…ôr budaqda 10 qu≈ü var. C…ômi ne√ß…ô qu≈ü var?", o: ["10", "100", "1000", "110"], c: 1 },
            { q: "Hansƒ± t…ôk r…ôq…ômli …ôd…ôdi 2-y…ô vurduqda 2 r…ôq…ômli …ôd…ôd alƒ±nmƒ±r?", o: ["4", "5", "6", "7"], c: 0 },
            { q: "Yarƒ±sƒ± 5 olan …ôd…ôdin 3 qatƒ± ne√ß…ôdir?", o: ["15", "25", "30", "45"], c: 2 },
            { q: "M…ônim 3 almam var, s…ôn m…ôn…ô 2-sini verdin. ƒ∞ndi m…ônim ne√ß…ô almam var?", o: ["2", "3", "5", "1"], c: 1 },
            { q: "Hansƒ± r…ôq…ômin adƒ± il…ô yazƒ±lƒ±≈üƒ± eyni sayda h…ôrfd…ôn ibar…ôtdir?", o: ["1", "3", "4", "6"], c: 2 },
            { q: "Divarda 5 mil√ß…ôk var idi, 2-sini √∂ld√ºrd√ºl…ôr. Divarda ne√ß…ô mil√ß…ôk qaldƒ±?", o: ["0", "2", "3", "5"], c: 1 },
            { q: "Hansƒ± heyvanƒ±n adƒ± 2 h…ôrfd…ôn ibar…ôtdir?", o: ["At", "ƒ∞t", "Fil", "Ayƒ±"], c: 0 },
            { q: "G√ºnd√ºzl…ôr yatƒ±r, gec…ôl…ôr u√ßur, amma qu≈ü deyil?", o: ["Yarasa", "Bayqu≈ü", "K…ôp…ôn…ôk", "Arƒ±"], c: 0 },
            { q: "Hansƒ± suala 'Xeyr' cavabƒ± verm…ôk m√ºmk√ºn deyil?", o: ["Acsan?", "Saƒüsan?", "G√∂r√ºrs…ôn?", "Gedirs…ôn?"], c: 1 },
            { q: "N…ôdir ki, hamƒ±dan …ôvv…ôl ev…ô girir?", o: ["A√ßar", "ƒ∞≈üƒ±q", "Pi≈üik", "K√ºl…ôk"], c: 0 },
            { q: "Komp√ºterin 'beyni' hansƒ± hiss…ôdir?", o: ["RAM", "Monitor", "Prosessor", "Klaviatura"], c: 2 },
            { q: "D√ºnyanƒ±n ilk proqram√ßƒ±sƒ± kim olub?", o: ["Bill Gates", "Elon Musk", "Ada Lovelace", "Mark Zuckerberg"], c: 2 },
            { q: "Bit n…ôyin qƒ±saltmasƒ±dƒ±r?", o: ["Big IT", "Binary Digit", "Basic Tool", "Binary Inter"], c: 1 },
            { q: "Hansƒ± proqramla≈üdƒ±rma dili daha q…ôdimdir?", o: ["Python", "C++", "Java", "JavaScript"], c: 1 },
            { q: "URL n…ôdir?", o: ["≈û…ôkil", "ƒ∞nternet √ºnvanƒ±", "Fayl", "Virus"], c: 1 },
            { q: "D…ôd…ô Qorqud boylarƒ±nda ne√ß…ô boy var?", o: ["10", "12", "15", "20"], c: 1 },
            { q: "≈ûu≈üa ili ne√ß…ônci il elan olunmu≈üdu?", o: ["2020", "2021", "2022", "2023"], c: 2 },
            { q: "Az…ôrbaycanƒ±n ilk paytaxtƒ± haradƒ±r?", o: ["G…ônc…ô", "T…ôbriz", "Bakƒ±", "Q…ôdim Q…ôb…ôl…ô"], c: 3 },
            { q: "Qƒ±z qalasƒ± hansƒ± ≈ü…ôh…ôrd…ô yerl…ô≈üir?", o: ["G…ônc…ô", "Bakƒ±", "Nax√ßƒ±van", "L…ônk…ôran"], c: 1 },
            { q: "Hansƒ± al…ôt Az…ôrbaycanƒ±n milli musiqi al…ôtidir?", o: ["Gitara", "Tar", "Skripka", "Pianino"], c: 1 },
            { q: "15 x 4 + 10 = ?", o: ["60", "70", "80", "100"], c: 1 },
            { q: "100-√ºn 10%-i ne√ß…ôdir?", o: ["1", "5", "10", "20"], c: 2 },
            { q: "Hansƒ± …ôd…ôd h…ôm t…ôkdir, h…ôm d…ô c√ºt?", o: ["0", "1", "2", "He√ß biri"], c: 3 },
            { q: "Bir sutka ne√ß…ô saniy…ôdir?", o: ["3600", "24000", "86400", "60000"], c: 2 },
            { q: "Kvadratƒ±n ne√ß…ô t…ôr…ôfi var?", o: ["3", "4", "5", "6"], c: 1 },
            { q: "Hansƒ± r…ôq…ôm Roma r…ôq…ôml…ôri sistemind…ô m√∂vcud deyil?", o: ["I", "V", "X", "0"], c: 3 },
            { q: "D√ºnyanƒ±n …ôn uzun sahil x…ôttin…ô malik √∂lk…ôsi hansƒ±dƒ±r?", o: ["Rusiya", "Kanada", "Avstraliya", "AB≈û"], c: 1 },
            { q: "≈ûahmatda 'En Passant' gedi≈üi hansƒ± fiqura aiddir?", o: ["At", "Piyada", "Fil", "≈ûah"], c: 1 },
            { q: "ƒ∞≈üƒ±q s√ºr…ôti t…ôxmin…ôn saniy…ôd…ô ne√ß…ô kilometrdir?", o: ["150.000", "200.000", "300.000", "400.000"], c: 2 },
            { q: "ƒ∞nsan b…ôd…ônind…ôki …ôn ki√ßik s√ºm√ºk haradadƒ±r?", o: ["Burun", "Qulaq", "Barmaq", "Diz"], c: 1 },
            { q: "Hansƒ± elementin kimy…ôvi simvolu 'W'-dir?", o: ["Qƒ±zƒ±l", "D…ômir", "Volfram", "G√ºm√º≈ü"], c: 2 },
            { q: "ƒ∞lk komp√ºter proqram√ßƒ±sƒ± kim hesab olunur?", o: ["Marie Curie", "Ada Lovelace", "Grace Hopper", "Hedy Lamarr"], c: 1 },
            { q: "D√ºnyada …ôn √ßox dild…ô danƒ±≈üƒ±lan √∂lk…ô hansƒ±dƒ±r?", o: ["Hindistan", "√áin", "Papua Yeni Qvineya", "Braziliya"], c: 2 },
            { q: "Vatikan d√∂vl…ôtinin r…ôsmi dili hansƒ±dƒ±r?", o: ["ƒ∞talyan", "Latƒ±n", "Fransƒ±z", "ƒ∞span"], c: 1 },
            { q: "G√ºn…ô≈ü sistemind…ô √∂z oxu …ôtrafƒ±nda …ôn s√ºr…ôtli fƒ±rlanan planet?", o: ["Yupiter", "Mars", "Yer", "Merkuri"], c: 0 },
            { q: "f(x) = x¬≤ + 2x + 1 t√∂r…ôm…ôsi f'(2) ne√ß…ôdir?", o: ["4", "5", "6", "8"], c: 2 },
            { q: "log‚ÇÇ(x-3) = 4 olarsa, x ne√ß…ôdir?", o: ["11", "13", "16", "19"], c: 3 },
            { q: "ƒ∞ki r…ôq…ômli …ôd…ôdin r…ôq…ôml…ôri c…ômi 9-dur. Bu …ôd…ôdd…ôn 9 √ßƒ±xdƒ±qda r…ôq…ôml…ôr yerini d…ôyi≈üir. ∆èd…ôd ne√ß…ôdir?", o: ["45", "54", "63", "72"], c: 1 },
            { q: "Bir kubun b√ºt√ºn s…ôthl…ôrini boyamaq √º√ß√ºn 54 sm¬≤ boya lazƒ±mdƒ±rsa, kubun t…ôr…ôfi ne√ß…ôdir?", o: ["2", "3", "4", "6"], c: 1 },
            { q: "Determinantƒ± 0 olan matris nec…ô adlanƒ±r?", o: ["Vahid", "Cƒ±rla≈ümƒ±≈ü", "T…ôrs", "Diaqonal"], c: 1 },
            { q: "9, 16, 25, 36, ? Ardƒ±cƒ±llƒ±ƒüƒ± tamamlayƒ±n.", o: ["45", "49", "54", "64"], c: 1 },
            { q: "ƒ∞ki z…ôr atƒ±lƒ±r. √úst √ºz…ô d√º≈ü…ôn xallarƒ±n c…ôminin 10 olmasƒ± ehtimalƒ±?", o: ["1/12", "3/36", "1/6", "5/36"], c: 1 },
            { q: "9-cu d…ôr…ôc…ôd…ôn k√∂k altƒ±nda 512 ne√ß…ôdir?", o: ["2", "3", "4", "8"], c: 0 },
            { q: "Sinus 90 d…ôr…ôc…ôd…ô ne√ß…ôy…ô b…ôrab…ôrdir?", o: ["0", "0.5", "1", "-1"], c: 2 },
            { q: "Hansƒ± proqramla≈üdƒ±rma dili 'Low-level' hesab olunur?", o: ["Python", "Java", "Assembly", "PHP"], c: 2 }
        ];

        let currentUser = null;
        let adminClicks = 0;
        let gameTimer;

        function getRank(bits) {
            if(bits >= 5000) return { name: "∆èfsan…ô", color: "#ff0000" };
            if(bits >= 1000) return { name: "Master", color: "#ffcc00" };
            return { name: "Pilot", color: "#00f2ff" };
        }

        function toggleAuth(isLogin) {
            document.getElementById('auth-reg').classList.toggle('hidden', isLogin);
            document.getElementById('auth-login').classList.toggle('hidden', !isLogin);
        }

        function register() {
            let name = document.getElementById('reg-name').value;
            let pass = document.getElementById('reg-pass').value;
            if(name.length < 3 || pass.length < 4) return alert("Ad v…ô ya ≈ûifr…ô √ßox qƒ±sadƒ±r!");
            
            let id = "BIT-" + Math.floor(1000 + Math.random() * 9000);
            let newUser = { id, name, pass, bits: 0, limit: 2, isVIP: false, lastLogin: Date.now(), friends: [], status: "online" };
            
            db.ref('users/' + id).set(newUser).then(() => {
                alert("Qeydiyyat uƒüurlu! ID-niz: " + id);
                loginWithUser(newUser);
            });
        }

        function login() {
            let id = document.getElementById('login-id').value.toUpperCase();
            let pass = document.getElementById('login-pass').value;
            
            db.ref('users/' + id).once('value', s => {
                if(s.exists()){
                    let u = s.val();
                    if(u.pass === pass) loginWithUser(u);
                    else alert("≈ûifr…ô s…ôhvdir!");
                } else alert("ID tapƒ±lmadƒ±!");
            });
        }

        function loginWithUser(user) {
            currentUser = user;
            localStorage.setItem('bb_user_id', user.id);
            db.ref('users/' + user.id).update({ status: "online" });
            
            checkBonusAvailability();
            updateDash();
            show('scr-dash');
            startLeaderboardSync();
            listenChat();
            syncFriends();
        }

        /* --- Dostluq Funksiyalarƒ± --- */
        function showFriendPanel() {
            document.getElementById('friend-section').classList.toggle('hidden');
        }

        function sendFriendRequest() {
            const fid = document.getElementById('friend-id-input').value.toUpperCase();
            if(!fid || fid === currentUser.id) return alert("Ke√ß…ôrsiz ID!");
            
            db.ref('users/' + fid).once('value', s => {
                if(s.exists()) {
                    if(!currentUser.friends) currentUser.friends = [];
                    if(currentUser.friends.includes(fid)) return alert("Bu ≈ü…ôxs artƒ±q dost siyahƒ±sƒ±ndadƒ±r!");
                    
                    currentUser.friends.push(fid);
                    saveToDB();
                    alert(fid + " dost olaraq …ôlav…ô edildi!");
                    syncFriends();
                } else alert("Bel…ô bir ID tapƒ±lmadƒ±!");
            });
        }

        function syncFriends() {
            if(!currentUser.friends || currentUser.friends.length === 0) {
                document.getElementById('active-friends-list').innerHTML = "<p style='font-size:0.6rem;'>H…ôl…ô dostun yoxdur.</p>";
                return;
            }

            db.ref('users').on('value', snap => {
                let html = "";
                let users = snap.val();
                currentUser.friends.forEach(fid => {
                    let u = users[fid];
                    if(u) {
                        let isOnline = u.status === "online";
                        html += `
                        <div class="friend-row">
                            <span><span class="status-dot ${isOnline ? 'status-online' : ''}"></span> ${u.name} (${u.id})</span>
                            <button onclick="challengeFriend('${u.id}')" style="background:none; border:1px solid var(--neon-blue); color:white; font-size:0.5rem; cursor:pointer;">D∆èV∆èT</button>
                        </div>`;
                    }
                });
                document.getElementById('active-friends-list').innerHTML = html;
            });
        }

        function startDuel(mode) {
            show('scr-matchmaking');
            let timer = 0;
            let mTimer = setInterval(() => {
                timer++;
                let min = String(Math.floor(timer/60)).padStart(2, '0');
                let sec = String(timer%60).padStart(2, '0');
                document.getElementById('match-timer').innerText = `${min}:${sec}`;
                
                if(timer === 3) {
                    document.getElementById('match-players').innerHTML = `
                        <div>S∆èN: ${currentUser.name}</div>
                        <div>R∆èQƒ∞B 1: D√∂y√º≈ü√ß√º_${Math.floor(Math.random()*100)}</div>
                        ${mode === '2v2' ? '<div>T∆èR∆èFDA≈ûIN: Random_Pro</div><div>R∆èQƒ∞B 2: Master_Bit</div>' : ''}
                    `;
                    document.getElementById('match-status').innerText = "R∆èQƒ∞BL∆èR TAPILDI! D√ñY√ú≈û BA≈ûLAYIR...";
                }

                if(timer === 6) {
                    clearInterval(mTimer);
                    startGame();
                }
            }, 1000);
        }

        function challengeFriend(fid) {
            alert(fid + " ID-li dosta duel d…ôv…ôti g√∂nd…ôrildi! G√∂zl…ônilir...");
        }

        /* --- Klassik Funksiyalar --- */
        function startLeaderboardSync() {
            db.ref('users').orderByChild('bits').limitToLast(10).on('value', (snapshot) => {
                let list = []; snapshot.forEach(child => { list.push(child.val()); });
                list.reverse();
                let html = "";
                list.forEach((u, i) => {
                    const rank = getRank(u.bits);
                    html += `<div class="leader-item">
                        <span>${i+1}. ${u.name} <small style="color:${rank.color}">[${rank.name}]</small>${u.isVIP ? '<span class="vip-tag">VIP</span>' : ''}</span>
                        <div>
                            <span style="color:var(--neon-blue); margin-right:10px;">${u.bits}</span>
                        </div>
                    </div>`;
                });
                document.getElementById('leader-list').innerHTML = html;
            });
        }

        function sendMsg() {
            const inp = document.getElementById('chat-input');
            const txt = inp.value.trim();
            if(txt && currentUser) {
                db.ref('chat').push({ u: currentUser.name, t: txt, v: currentUser.isVIP, ts: firebase.database.ServerValue.TIMESTAMP });
                inp.value = "";
            }
        }

        function listenChat() {
            db.ref('chat').limitToLast(12).on('value', snap => {
                const box = document.getElementById('chat-messages');
                box.innerHTML = "";
                snap.forEach(c => {
                    const m = c.val();
                    const d = document.createElement('div');
                    d.className = "chat-msg";
                    d.innerHTML = `<span class="chat-user" style="color:${m.v ? 'var(--neon-green)':'var(--neon-blue)'}">${m.u}:</span> ${m.t}`;
                    box.appendChild(d);
                });
                box.scrollTop = box.scrollHeight;
            });
        }

        function show(id) {
            document.querySelectorAll('.card').forEach(c => c.classList.add('hidden'));
            document.getElementById(id).classList.remove('hidden');
        }

        function checkBonusAvailability() {
            const today = new Date().toDateString();
            const lastDate = currentUser.lastBonusDate || "";
            const giftBtn = document.getElementById('gift-trigger');
            if(today === lastDate) { giftBtn.style.display = "none"; } 
            else { giftBtn.style.display = "inline-flex"; }
        }

        function claimDailyBonus() {
            const today = new Date().toDateString();
            currentUser.limit += 2;
            currentUser.lastBonusDate = today;
            saveToDB();
            updateDash();
            checkBonusAvailability();
            sfx.correct.play().catch(e => {});
            alert("T…ôbrikl…ôr! G√ºnd…ôlik +2 Limit H…ôdiyy…ô Edildi üéÅ");
        }

        function updateDash() {
            if(!currentUser) return;
            const rank = getRank(currentUser.bits);
            document.getElementById('u-id').innerText = currentUser.id;
            document.getElementById('u-welcome').innerText = currentUser.name;
            document.getElementById('u-bits').innerText = currentUser.bits;
            document.getElementById('u-limit').innerText = currentUser.isVIP ? "‚àû" : currentUser.limit + "/2";
            
            const rTag = document.getElementById('u-rank');
            rTag.innerText = rank.name;
            rTag.style.background = rank.color;
            rTag.style.color = "black";

            let container = document.getElementById('btn-container');
            container.innerHTML = (!currentUser.isVIP && currentUser.limit <= 0) ? 
                `<button class="btn btn-wa pulse-btn" onclick="contactAdmin()">Lƒ∞Mƒ∞TSƒ∞Z AL</button>` : 
                `<button class="btn pulse-btn" onclick="startGame()">T∆èK N∆èF∆èRLƒ∞K M∆è≈ûQ</button>`;
        }

        function startGame() {
            if(!currentUser.isVIP) { currentUser.limit--; saveToDB(); }
            show('scr-game'); loadQuestion();
        }

        function loadQuestion() {
            clearInterval(gameTimer);
            let time = 10;
            document.getElementById('timer').innerText = time;
            document.getElementById('timer').style.color = "var(--neon-green)";
            let q = questions[Math.floor(Math.random()*questions.length)];
            document.getElementById('q-text').innerText = q.q;
            let opts = document.getElementById('q-opts');
            opts.innerHTML = "";
            q.o.forEach((o, i) => {
                let b = document.createElement('button'); b.className = "opt-btn"; b.innerText = o;
                b.onclick = () => {
                    if(i === q.c) { 
                        sfx.correct.play().catch(e => {});
                        currentUser.bits += 50; saveToDB(); loadQuestion(); 
                    } else { 
                        sfx.wrong.play().catch(e => {});
                        alert("YALNI≈û!"); show('scr-dash'); updateDash(); 
                    }
                };
                opts.appendChild(b);
            });
            gameTimer = setInterval(() => {
                time--; document.getElementById('timer').innerText = time;
                if(time <= 3) document.getElementById('timer').style.color = "red";
                if(time <= 0) { sfx.wrong.play().catch(e => {}); clearInterval(gameTimer); show('scr-dash'); updateDash(); }
            }, 1000);
        }

        function saveToDB() { if(currentUser) db.ref('users/' + currentUser.id).update(currentUser); }
        function logout() { 
            if(currentUser) db.ref('users/' + currentUser.id).update({ status: "offline" });
            localStorage.removeItem('bb_user_id'); 
            location.reload(); 
        }
        function contactAdmin() { window.open(`https://wa.me/994773220807?text=ID: ${currentUser.id} limit ist…ôyir…ôm`, '_blank'); }
        
        function adminClick() { adminClicks++; if(adminClicks >= 5) { adminClicks = 0; show('scr-admin'); db.ref('users').once('value', s => { document.getElementById('admin-count').innerText = "C…ômi: " + s.numChildren(); }); } }

        function checkAdmin() {
            let pass = document.getElementById('admin-pass').value;
            db.ref('settings/adminPass').once('value', s => {
                if(s.exists() && s.val() === pass) document.getElementById('admin-tools').classList.remove('hidden');
                else alert("S…ôhv!");
            });
        }

        function makeVIP() {
            let tid = document.getElementById('target-id').value.toUpperCase();
            db.ref('users/' + tid).update({ isVIP: true }).then(() => alert("VIP aktiv edildi!"));
        }

        window.onload = () => {
            let savedId = localStorage.getItem('bb_user_id');
            if(savedId) db.ref('users/' + savedId).once('value', s => s.exists() ? loginWithUser(s.val()) : startLeaderboardSync());
            else startLeaderboardSync();
        }

        // Browser baƒülananda offline et
        window.onbeforeunload = () => { if(currentUser) db.ref('users/' + currentUser.id).update({ status: "offline" }); };

        document.getElementById('chat-input')?.addEventListener('keypress', (e) => { if(e.key === 'Enter') sendMsg(); });
    </script>
</body>
</html>
